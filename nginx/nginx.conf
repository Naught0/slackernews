# This is the main Nginx configuration file. It controls the
# overall behavior of the Nginx server.

# 'user' defines the user and group Nginx worker processes will run as.
# 'www-data' is a common default on Debian/Ubuntu systems.
user www-data;

# 'worker_processes' specifies the number of worker processes to run.
# 'auto' is a good default, as it will auto-detect the number of CPU cores.
worker_processes auto;

# 'pid' specifies the location of the master process ID file.
pid /run/nginx.pid;

# The 'include' directive pulls in other configuration files.
# This is a key feature for modularizing your configuration.
# The 'modules-enabled/*.conf' line includes any additional modules.
include /etc/nginx/modules-enabled/*.conf;

# The 'events' block contains settings for connection processing.
events {
    # 'worker_connections' sets the maximum number of simultaneous
    # connections that can be opened by a single worker process.
    # 1024 is a common default.
    worker_connections 1024;
}

# The 'http' block contains directives for web traffic handling.
http {
    # 'sendfile' optimizes file transfers by copying data directly from one
    # file descriptor to another, bypassing user space. This is very efficient.
    sendfile on;

    # 'tcp_nopush' bundles TCP headers with data from 'sendfile'.
    tcp_nopush on;

    # 'tcp_nodelay' ensures that data is sent immediately, without waiting for
    # a full buffer. This is useful for interactive applications.
    tcp_nodelay on;

    # 'keepalive_timeout' sets the timeout for keep-alive connections.
    keepalive_timeout 65;

    # 'types_hash_max_size' sets the maximum size of the server name hash tables.
    types_hash_max_size 2048;
    
    # 'default_type' sets the default MIME type if a file type is not recognized.
    default_type application/octet-stream;

    # 'ssl_protocols' and 'ssl_prefer_server_ciphers' are important for security
    # when serving HTTPS. They define the accepted SSL/TLS protocols and ciphers.
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;

    # 'gzip' enables compression for faster transfer of data.
    gzip on;

    # 'include /etc/nginx/conf.d/*.conf;' is the most important part
    # for your use case. It tells Nginx to load any `.conf` files
    # from the `conf.d` directory. This is where you put
    # your site-specific configurations, like the one we discussed earlier.
    include /etc/nginx/conf.d/*.conf;
}

